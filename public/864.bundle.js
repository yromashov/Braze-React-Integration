"use strict";(self.webpackChunkbraze_web_sdk_tutorial=self.webpackChunkbraze_web_sdk_tutorial||[]).push([[864],{4864:(t,e,s)=>{s.r(e),s.d(e,{showFeed:()=>b});var n=s(3774),r=s(1311),l=s(67),i=s(1066),o=s(1280),h=s(158),a=s(3153),u=s(7750),c=s(5966),d=s(4663);class f extends h.Z{constructor(t,e){super(),this.h=t,this.Is=e,this.vt=new d.Z,n.ZP.Ut(this.vt),this.zt()}zt(){const t=this.h.I(c.I.q.Ks)||[],e=[];for(let s=0;s<t.length;s++){const n=(0,a.rN)(t[s]);null!=n&&e.push(n)}this.Xt=e,this.Os=(0,u.Rd)(this.h.I(c.I.q.Qs))}Vs(t){const e=[];let s=null;const n=this.h.I(c.I.q.P)||{},r={};for(let l=0;l<t.length;l++){s=t[l];const i=(0,a.D5)(s);null!=i&&(n[i.id]&&(i.viewed=!0,r[i.id]=!0),e.push(i))}this.h.B(c.I.q.P,r),this.Xt=e,this.Ss(),this.Os=new Date,this.h.B(c.I.q.Qs,this.Os)}Ss(){const t=[];for(let e=0;e<this.Xt.length;e++)t.push(this.Xt[e].ss());this.h.B(c.I.q.Ks,t)}_s(t){null!=t&&t.feed&&(this.zt(),this.Vs(t.feed),this.vt.Nt(new v(this.Xt.slice(),this.Os)))}Ws(){this.zt();const t=[],e=new Date;for(let s=0;s<this.Xt.length;s++)(null==this.Xt[s].expiresAt||this.Xt[s].expiresAt>=e)&&t.push(this.Xt[s]);return new v(t,this.Os)}Ts(){this.Is.requestFeedRefresh()}Ps(t){return this.vt.Et(t)}clearData(t){null==t&&(t=!1),this.Xt=[],this.Os=null,t&&(this.h.$s(c.I.q.Ks),this.h.$s(c.I.q.Qs)),this.vt.Nt(new v(this.Xt.slice(),this.Os))}}const p={t:!1,provider:null,er:()=>(p.o(),p.provider||(p.provider=new f(n.ZP.l(),n.ZP.mr()),n.ZP.ar(p.provider)),p.provider),o:()=>{p.t||(n.ZP.u(p),p.t=!0)},destroy:()=>{p.provider=null,p.t=!1}},w=p;class v extends l.Z{constructor(t,e){super(t,e)}logCardImpressions(t){(0,i.p)(t,!1)}logCardClick(t){(0,o.d)(t,!1)}sr(){n.ZP.rr()&&w.er().Ts()}dr(){return!1}}var P=s(2367),Z=s(2893),g=s(9590),I=s(6959);function b(t,e,s){if(!n.ZP.rr())return;(0,I.B)();const l=(t,e)=>{if(null==e)return t;const s=[];for(let t=0;t<e.length;t++)s.push(e[t].toLowerCase());const n=[];for(let e=0;e<t.length;e++){const r=[];for(let s=0;s<t[e].categories.length;s++)r.push(t[e].categories[s].toLowerCase());(0,Z.jV)(r,s).length>0&&n.push(t[e])}return n},i=n.ZP.nn(n.JY.tn)||n.ZP.nn(n.JY.en)||!1;let o=!1;null==t&&(t=document.body,o=!0);let h=!1,a=null;null==e?(a=w.er().Ws(),(0,r.Of)(a,l(a.cards,s),a.lastUpdated,null,i),h=!0):a=new v(l(e,s),new Date);const u=(0,r.Yz)(a,i);if(h){(null==a.lastUpdated||(new Date).valueOf()-a.lastUpdated.valueOf()>v.ur)&&(P.Z.D.info(`Cached feed was older than max TTL of ${v.ur} ms, requesting an update from the server.`),(0,r.cV)(a,u));const t=(new Date).valueOf(),e=function(e){if(n.ZP.rr())return w.er().Ps((function(e){const n=u.querySelectorAll(".ab-refresh-button")[0];if(null!=n){let e=500;const s=parseInt(u.getAttribute(r.cP));isNaN(s)?e-=(new Date).valueOf()-t:e-=(new Date).valueOf()-s,setTimeout((function(){n.className=n.className.replace(/fa-spin/g,"")}),Math.max(e,0))}(0,r.Of)(a,l(e.cards,s),e.lastUpdated,u,i)}))}();(0,r.GB)(e,u)}const c=t=>{const e=t.querySelectorAll(".ab-feed");let s=null;for(let n=0;n<e.length;n++)e[n].parentNode===t&&(s=e[n]);null!=s?((0,r.tQ)(s),s.parentNode.replaceChild(u,s)):t.appendChild(u),setTimeout((function(){u.className=u.className.replace("ab-hide","ab-show")}),0),o&&u.focus(),n.ZP.rr()&&n.ZP.nr().yr(P.Z.qr.Fr).S,(0,r.cz)(a,u),(0,g.CG)(a.cards,t)};var d;null!=t?c(t):window.onload=(d=window.onload,function(){"function"==typeof d&&d(),c(document.body)})}}}]);
//# sourceMappingURL=864.bundle.js.map